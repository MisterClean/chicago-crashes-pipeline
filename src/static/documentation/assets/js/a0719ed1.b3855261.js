"use strict";(self.webpackChunkchicago_crashes_pipeline_docs=self.webpackChunkchicago_crashes_pipeline_docs||[]).push([[331],{3756:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"operations/deployment","title":"Deployment Guide","description":"Deploy the pipeline with Docker Compose or production-ready infrastructure.","source":"@site/docs/operations/deployment.md","sourceDirName":"operations","slug":"/operations/deployment","permalink":"/documentation/operations/deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/MisterClean/chicago-crashes-pipeline/tree/main/docs/operations/deployment.md","tags":[],"version":"current","lastUpdatedAt":null,"sidebarPosition":2,"frontMatter":{"title":"Deployment Guide","sidebar_position":2,"description":"Deploy the pipeline with Docker Compose or production-ready infrastructure."},"sidebar":"guideSidebar","previous":{"title":"Operations Overview","permalink":"/documentation/operations/operations-overview"},"next":{"title":"Troubleshooting","permalink":"/documentation/operations/troubleshooting"}}');var t=i(4848),o=i(8453);const r={title:"Deployment Guide",sidebar_position:2,description:"Deploy the pipeline with Docker Compose or production-ready infrastructure."},l=void 0,a={},c=[{value:"Option 1: Docker Compose (Small Teams / Demos)",id:"option-1-docker-compose-small-teams--demos",level:2},{value:"Option 2: Container Orchestrator (Kubernetes, ECS, Nomad)",id:"option-2-container-orchestrator-kubernetes-ecs-nomad",level:2},{value:"Option 3: VM / Bare Metal",id:"option-3-vm--bare-metal",level:2},{value:"Deployment Pipeline Extras",id:"deployment-pipeline-extras",level:2},{value:"Zero-Downtime Tips",id:"zero-downtime-tips",level:2},{value:"Deployment Verification Checklist",id:"deployment-verification-checklist",level:2}];function d(e){const n={code:"code",h2:"h2",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"This guide covers deployment patterns for the Chicago Crash Data Pipeline. Choose the approach that matches your hosting environment and operational maturity."}),"\n",(0,t.jsx)(n.h2,{id:"option-1-docker-compose-small-teams--demos",children:"Option 1: Docker Compose (Small Teams / Demos)"}),"\n",(0,t.jsx)(n.p,{children:"Use the repo's Compose stack for quick deployments on a single host."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose -f docker/docker-compose.yml up --build -d\n"})}),"\n",(0,t.jsx)(n.p,{children:"Recommendations:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Populate an ",(0,t.jsx)(n.code,{children:".env"})," file with strong credentials and pass it via ",(0,t.jsx)(n.code,{children:"--env-file"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Remove the ",(0,t.jsx)(n.code,{children:"--reload"})," flag from the ",(0,t.jsx)(n.code,{children:"app"})," service command for production stability."]}),"\n",(0,t.jsx)(n.li,{children:"Add a reverse proxy in front of the FastAPI container for TLS termination (NGINX, Traefik, Caddy)."}),"\n",(0,t.jsxs)(n.li,{children:["Configure host-level backups for the ",(0,t.jsx)(n.code,{children:"postgres_data"})," volume."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"option-2-container-orchestrator-kubernetes-ecs-nomad",children:"Option 2: Container Orchestrator (Kubernetes, ECS, Nomad)"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Build and push the application image:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker build -t <registry>/chicago-crashes-api:latest -f docker/Dockerfile .\ndocker push <registry>/chicago-crashes-api:latest\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Provision managed PostgreSQL (with PostGIS enabled) and Redis. For AWS:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Amazon RDS for PostgreSQL (enable PostGIS extension)"}),"\n",(0,t.jsx)(n.li,{children:"Amazon ElastiCache for Redis"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Deploy the API container with environment variables stored in Secrets/ConfigMaps. Mount the ",(0,t.jsx)(n.code,{children:"config/config.yaml"})," file via a ConfigMap or baked into the image."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Expose port 8000 via an ingress controller or application load balancer."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Configure horizontal pod autoscaling based on CPU or request latency if you expect spikes during heavy sync windows."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"option-3-vm--bare-metal",children:"Option 3: VM / Bare Metal"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Install Python 3.11, PostgreSQL 15 + PostGIS, and Redis 7."}),"\n",(0,t.jsxs)(n.li,{children:["Create a systemd service that runs ",(0,t.jsx)(n.code,{children:"uvicorn src.api.main:app --host 0.0.0.0 --port 8000 --workers 4"})," inside a virtual environment."]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"supervisord"})," or systemd timers to run scheduled sync jobs if you prefer OS-level scheduling over the built-in job scheduler (disable the internal scheduler by omitting it from startup)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"deployment-pipeline-extras",children:"Deployment Pipeline Extras"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Concern"}),(0,t.jsx)(n.th,{children:"Recommendation"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Configuration"})}),(0,t.jsxs)(n.td,{children:["Store ",(0,t.jsx)(n.code,{children:".env"})," values in a secret manager (AWS Secrets Manager, HashiCorp Vault, Doppler). Commit only non-sensitive defaults in Git."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Database Migrations"})}),(0,t.jsxs)(n.td,{children:["Run ",(0,t.jsx)(n.code,{children:"alembic upgrade head"})," during release pipelines before starting new application instances."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Logging"})}),(0,t.jsxs)(n.td,{children:["Ship ",(0,t.jsx)(n.code,{children:"logs/api.log"}),", ",(0,t.jsx)(n.code,{children:"logs/etl.log"}),", and ",(0,t.jsx)(n.code,{children:"logs/app.log"})," to a central aggregator (CloudWatch, ELK, Loki)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Metrics"})}),(0,t.jsxs)(n.td,{children:["Scrape ",(0,t.jsx)(n.code,{children:"GET /health"}),", track sync durations via executed job metadata, and expose container metrics via cAdvisor or node exporter."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Alerting"})}),(0,t.jsx)(n.td,{children:"Create alerts for failed executions, high job latency, database replication lag, and approaching SODA rate limits."})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"zero-downtime-tips",children:"Zero-Downtime Tips"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Run multiple API instances behind a load balancer; the admin portal is static so it scales trivially."}),"\n",(0,t.jsx)(n.li,{children:"Coordinate job scheduler ownership (only one instance should run the scheduler). Use an environment flag or leader-election mechanism if you run multiple API replicas."}),"\n",(0,t.jsx)(n.li,{children:"Perform backfills during off-peak hours or on dedicated workers to avoid blocking routine incremental jobs."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"deployment-verification-checklist",children:"Deployment Verification Checklist"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,t.jsx)(n.code,{children:"GET /health"})," returns ",(0,t.jsx)(n.code,{children:"healthy"})]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Admin portal loads and displays live job statistics"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Test sync (",(0,t.jsx)(n.code,{children:"POST /sync/test"}),") succeeds"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Database contains expected tables with PostGIS extension enabled (",(0,t.jsx)(n.code,{children:"SELECT PostGIS_full_version();"}),")"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Logs flow to the configured aggregation system"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Once these checks pass you are ready to hand over the environment to operators and analysts."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(6540);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);