"use strict";(self.webpackChunkchicago_crashes_pipeline_docs=self.webpackChunkchicago_crashes_pipeline_docs||[]).push([[771],{5108:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"operations/security","title":"Security Best Practices","description":"Security considerations for production deployments","source":"@site/docs/operations/security.md","sourceDirName":"operations","slug":"/operations/security","permalink":"/documentation/operations/security","draft":false,"unlisted":false,"editUrl":"https://github.com/MisterClean/chicago-crashes-pipeline/tree/main/docs/operations/security.md","tags":[],"version":"current","lastUpdatedAt":null,"sidebarPosition":4,"frontMatter":{"title":"Security Best Practices","sidebar_position":4,"description":"Security considerations for production deployments"}}');var t=i(4848),r=i(8453);const a={title:"Security Best Practices",sidebar_position:4,description:"Security considerations for production deployments"},l="Security Best Practices",c={},o=[{value:"Environment Configuration",id:"environment-configuration",level:2},{value:"1. Secure Credentials",id:"1-secure-credentials",level:3},{value:"2. CORS Configuration",id:"2-cors-configuration",level:3},{value:"3. Database Security",id:"3-database-security",level:3},{value:"4. API Security",id:"4-api-security",level:3},{value:"5. Rate Limiting",id:"5-rate-limiting",level:3},{value:"6. HTTPS Configuration",id:"6-https-configuration",level:3},{value:"7. Security Headers",id:"7-security-headers",level:3},{value:"Production Deployment Checklist",id:"production-deployment-checklist",level:2},{value:"Credentials",id:"credentials",level:3},{value:"Network Security",id:"network-security",level:3},{value:"Application Security",id:"application-security",level:3},{value:"Database Security",id:"database-security",level:3},{value:"Monitoring &amp; Logging",id:"monitoring--logging",level:3},{value:"Dependencies",id:"dependencies",level:3},{value:"Authentication Implementation Guide",id:"authentication-implementation-guide",level:2},{value:"Option 1: API Key Authentication",id:"option-1-api-key-authentication",level:3},{value:"Option 2: JWT Token Authentication",id:"option-2-jwt-token-authentication",level:3},{value:"Option 3: OAuth2 with External Provider",id:"option-3-oauth2-with-external-provider",level:3},{value:"Monitoring &amp; Alerting",id:"monitoring--alerting",level:2},{value:"Log Aggregation",id:"log-aggregation",level:3},{value:"Security Event Monitoring",id:"security-event-monitoring",level:3},{value:"Data Protection",id:"data-protection",level:2},{value:"Sensitive Data Handling",id:"sensitive-data-handling",level:3},{value:"Compliance",id:"compliance",level:3},{value:"Incident Response",id:"incident-response",level:2},{value:"Security Incident Procedure",id:"security-incident-procedure",level:3},{value:"Security Contacts",id:"security-contacts",level:3},{value:"Additional Resources",id:"additional-resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"security-best-practices",children:"Security Best Practices"})}),"\n",(0,t.jsx)(n.p,{children:"This guide covers security considerations when deploying the Chicago Crash Data Pipeline in production environments."}),"\n",(0,t.jsx)(n.h2,{id:"environment-configuration",children:"Environment Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"1-secure-credentials",children:"1. Secure Credentials"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Never use default credentials in production."})}),"\n",(0,t.jsx)(n.p,{children:"Generate strong, unique passwords for all services:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Generate secure passwords\nopenssl rand -base64 32\n\n# Set in .env file\nDB_PASSWORD=<generated-password>\nPOSTGRES_PASSWORD=<same-as-above>\nCHICAGO_API_TOKEN=<your-api-token>\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Update docker-compose.yml"})," to use environment variables:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"postgres:\n  environment:\n    POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}  # From .env\n    # Remove: POSTGRES_HOST_AUTH_METHOD: trust\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use different passwords for each environment (dev, staging, production)"}),"\n",(0,t.jsx)(n.li,{children:"Store production credentials in a secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)"}),"\n",(0,t.jsx)(n.li,{children:"Rotate passwords every 90 days"}),"\n",(0,t.jsxs)(n.li,{children:["Never commit ",(0,t.jsx)(n.code,{children:".env"})," files to version control"]}),"\n",(0,t.jsx)(n.li,{children:"Use strong passwords: 32+ characters, alphanumeric + symbols"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-cors-configuration",children:"2. CORS Configuration"}),"\n",(0,t.jsx)(n.p,{children:"Configure allowed origins explicitly in production:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# .env\nCORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Never use wildcards in production:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# BAD - Security vulnerability\nallow_origins=["*"]\nallow_credentials=True\n\n# GOOD - Specific domains\nallowed_origins = os.getenv("CORS_ORIGINS", "").split(",")\nallow_origins=allowed_origins\nallow_credentials=True\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The application now uses environment-based CORS configuration in ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(8619).A+"#L82-L97",children:"src/api/main.py:82-97"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"3-database-security",children:"3. Database Security"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"PostgreSQL Hardening:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Disable trust authentication:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# docker-compose.yml - Remove this line:\n# POSTGRES_HOST_AUTH_METHOD: trust\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Use SSL/TLS connections:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Connection string with SSL\nDATABASE_URL=postgresql://user:pass@host:5432/db?sslmode=require\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Restrict network access:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# docker-compose.yml\npostgres:\n  networks:\n    - backend  # Internal network only\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configure connection limits:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"postgres:\n  command: >\n    -c max_connections=100\n    -c shared_buffers=256MB\n    -c effective_cache_size=1GB\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Enable query logging for auditing:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"postgres:\n  command: >\n    -c log_statement=mod\n    -c log_duration=on\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"4-api-security",children:"4. API Security"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Add Authentication to Admin Portal:"})}),"\n",(0,t.jsx)(n.p,{children:"The admin portal has no authentication by default. For production:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# src/api/dependencies.py\nfrom fastapi import Depends, HTTPException, status\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\n\nsecurity = HTTPBearer()\n\nasync def verify_token(credentials: HTTPAuthorizationCredentials = Depends(security)):\n    """Verify API token."""\n    token = credentials.credentials\n    expected_token = os.getenv("API_TOKEN")\n\n    if not expected_token or token != expected_token:\n        raise HTTPException(\n            status_code=status.HTTP_401_UNAUTHORIZED,\n            detail="Invalid authentication credentials"\n        )\n    return token\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Apply to protected routes:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# src/api/routers/jobs.py\nfrom src.api.dependencies import verify_token\n\n@router.post("/jobs", dependencies=[Depends(verify_token)])\nasync def create_job(...):\n    ...\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Alternative authentication methods:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"OAuth2 with JWT tokens"}),"\n",(0,t.jsx)(n.li,{children:"API keys in headers"}),"\n",(0,t.jsx)(n.li,{children:"Session-based authentication"}),"\n",(0,t.jsx)(n.li,{children:"Integration with identity providers (Auth0, Okta, etc.)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://fastapi.tiangolo.com/tutorial/security/",children:"FastAPI Security"})," for implementation guides."]}),"\n",(0,t.jsx)(n.h3,{id:"5-rate-limiting",children:"5. Rate Limiting"}),"\n",(0,t.jsx)(n.p,{children:"Implement rate limiting to prevent abuse:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Option 1: Application-level (slowapi)"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# src/api/main.py\nfrom slowapi import Limiter, _rate_limit_exceeded_handler\nfrom slowapi.util import get_remote_address\nfrom slowapi.errors import RateLimitExceeded\n\nlimiter = Limiter(key_func=get_remote_address)\napp.state.limiter = limiter\napp.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)\n\n@router.get("/sync/status")\n@limiter.limit("100/hour")\nasync def sync_status(request: Request):\n    ...\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Option 2: Reverse proxy (nginx)"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;\n\nserver {\n    location /api/ {\n        limit_req zone=api burst=20 nodelay;\n        proxy_pass http://app:8000;\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"6-https-configuration",children:"6. HTTPS Configuration"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Always use HTTPS in production."})," Run behind a reverse proxy:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"nginx example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 443 ssl http2;\n    server_name yourdomain.com;\n\n    ssl_certificate /path/to/fullchain.pem;\n    ssl_certificate_key /path/to/privkey.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n\n    location / {\n        proxy_pass http://localhost:8000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Caddy example (automatic HTTPS):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"yourdomain.com {\n    reverse_proxy localhost:8000\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"7-security-headers",children:"7. Security Headers"}),"\n",(0,t.jsx)(n.p,{children:"Add security headers via reverse proxy or FastAPI middleware:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# src/api/main.py\nfrom fastapi.middleware.trustedhost import TrustedHostMiddleware\nfrom fastapi.middleware.httpsredirect import HTTPSRedirectMiddleware\n\n# Force HTTPS\napp.add_middleware(HTTPSRedirectMiddleware)\n\n# Restrict allowed hosts\napp.add_middleware(\n    TrustedHostMiddleware,\n    allowed_hosts=["yourdomain.com", "www.yourdomain.com"]\n)\n\n# Add security headers\n@app.middleware("http")\nasync def add_security_headers(request: Request, call_next):\n    response = await call_next(request)\n    response.headers["X-Content-Type-Options"] = "nosniff"\n    response.headers["X-Frame-Options"] = "DENY"\n    response.headers["X-XSS-Protection"] = "1; mode=block"\n    response.headers["Strict-Transport-Security"] = "max-age=31536000; includeSubDomains"\n    return response\n'})}),"\n",(0,t.jsx)(n.h2,{id:"production-deployment-checklist",children:"Production Deployment Checklist"}),"\n",(0,t.jsx)(n.p,{children:"Before deploying to production:"}),"\n",(0,t.jsx)(n.h3,{id:"credentials",children:"Credentials"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All default passwords changed"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Strong, unique passwords generated (",(0,t.jsx)(n.code,{children:"openssl rand -base64 32"}),")"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Credentials stored in secrets manager"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,t.jsx)(n.code,{children:".env"})," file excluded from version control"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Different credentials for each environment"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"network-security",children:"Network Security"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HTTPS/TLS enabled"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Reverse proxy configured (nginx, Caddy, Traefik)"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Firewall rules restrict database access"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Docker networks properly isolated"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","CORS configured with specific allowed origins"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"application-security",children:"Application Security"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Authentication added to admin portal"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","API rate limiting implemented"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security headers configured"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Trusted host middleware enabled"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Input validation on all endpoints"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"database-security",children:"Database Security"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","PostgreSQL ",(0,t.jsx)(n.code,{children:"trust"})," method disabled"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","SSL/TLS for database connections"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Connection pooling limits configured"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Query logging enabled for auditing"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Regular backups configured"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"monitoring--logging",children:"Monitoring & Logging"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Structured logging enabled"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Log aggregation configured (ELK, Datadog, etc.)"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Error tracking (Sentry, Rollbar, etc.)"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Uptime monitoring"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security event alerts"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All dependencies updated"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,t.jsx)(n.code,{children:"pip-audit"})," and ",(0,t.jsx)(n.code,{children:"npm audit"})," passing"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Dependabot enabled for automated updates"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security advisories subscribed"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"authentication-implementation-guide",children:"Authentication Implementation Guide"}),"\n",(0,t.jsx)(n.h3,{id:"option-1-api-key-authentication",children:"Option 1: API Key Authentication"}),"\n",(0,t.jsx)(n.p,{children:"Simple API key-based authentication:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# src/api/dependencies.py\nfrom fastapi import Header, HTTPException\n\nasync def verify_api_key(x_api_key: str = Header(...)):\n    """Verify API key from header."""\n    expected_key = os.getenv("API_KEY")\n    if x_api_key != expected_key:\n        raise HTTPException(status_code=401, detail="Invalid API key")\n    return x_api_key\n\n# Apply to routes\n@router.post("/jobs", dependencies=[Depends(verify_api_key)])\nasync def create_job(...):\n    ...\n'})}),"\n",(0,t.jsx)(n.p,{children:"Usage:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -H "X-API-Key: your-secret-key" http://localhost:8000/jobs\n'})}),"\n",(0,t.jsx)(n.h3,{id:"option-2-jwt-token-authentication",children:"Option 2: JWT Token Authentication"}),"\n",(0,t.jsx)(n.p,{children:"More secure token-based authentication:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# src/api/auth.py\nfrom datetime import datetime, timedelta\nfrom jose import JWTError, jwt\nfrom fastapi import Depends, HTTPException, status\nfrom fastapi.security import OAuth2PasswordBearer\n\noauth2_scheme = OAuth2PasswordBearer(tokenUrl="token")\nSECRET_KEY = os.getenv("JWT_SECRET_KEY")\nALGORITHM = "HS256"\n\ndef create_access_token(data: dict, expires_delta: timedelta = None):\n    to_encode = data.copy()\n    expire = datetime.utcnow() + (expires_delta or timedelta(minutes=15))\n    to_encode.update({"exp": expire})\n    return jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)\n\nasync def get_current_user(token: str = Depends(oauth2_scheme)):\n    try:\n        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])\n        username: str = payload.get("sub")\n        if username is None:\n            raise HTTPException(status_code=401, detail="Invalid token")\n        return username\n    except JWTError:\n        raise HTTPException(status_code=401, detail="Invalid token")\n\n# Apply to routes\n@router.get("/jobs", dependencies=[Depends(get_current_user)])\nasync def list_jobs(...):\n    ...\n'})}),"\n",(0,t.jsx)(n.h3,{id:"option-3-oauth2-with-external-provider",children:"Option 3: OAuth2 with External Provider"}),"\n",(0,t.jsx)(n.p,{children:"Integrate with Auth0, Google, GitHub, etc.:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from authlib.integrations.starlette_client import OAuth\n\noauth = OAuth()\noauth.register(\n    name='google',\n    client_id=os.getenv('GOOGLE_CLIENT_ID'),\n    client_secret=os.getenv('GOOGLE_CLIENT_SECRET'),\n    server_metadata_url='https://accounts.google.com/.well-known/openid-configuration',\n    client_kwargs={'scope': 'openid email profile'}\n)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"monitoring--alerting",children:"Monitoring & Alerting"}),"\n",(0,t.jsx)(n.h3,{id:"log-aggregation",children:"Log Aggregation"}),"\n",(0,t.jsx)(n.p,{children:"Integrate with log aggregation services:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"ELK Stack:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# src/utils/logging.py\nimport logging\nfrom pythonjsonlogger import jsonlogger\n\nlogHandler = logging.StreamHandler()\nformatter = jsonlogger.JsonFormatter()\nlogHandler.setFormatter(formatter)\nlogger.addHandler(logHandler)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Datadog:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from ddtrace import tracer\nfrom ddtrace.contrib.fastapi import patch\n\npatch()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"security-event-monitoring",children:"Security Event Monitoring"}),"\n",(0,t.jsx)(n.p,{children:"Monitor for:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Failed authentication attempts"}),"\n",(0,t.jsx)(n.li,{children:"Unusual API access patterns"}),"\n",(0,t.jsx)(n.li,{children:"Database connection failures"}),"\n",(0,t.jsx)(n.li,{children:"High error rates"}),"\n",(0,t.jsx)(n.li,{children:"Slow query performance"}),"\n",(0,t.jsx)(n.li,{children:"Unauthorized access attempts"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example alert configuration:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# alertmanager.yml\nroutes:\n  - match:\n      severity: critical\n    receiver: 'pagerduty'\n  - match:\n      severity: warning\n    receiver: 'email'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"data-protection",children:"Data Protection"}),"\n",(0,t.jsx)(n.h3,{id:"sensitive-data-handling",children:"Sensitive Data Handling"}),"\n",(0,t.jsx)(n.p,{children:"The Chicago crash data is public, but implement best practices:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Data masking for PII:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"def mask_sensitive_fields(record):\n    if 'license_plate' in record:\n        record['license_plate'] = '***' + record['license_plate'][-3:]\n    return record\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Encryption at rest:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use encrypted database volumes"}),"\n",(0,t.jsx)(n.li,{children:"Encrypt backups"}),"\n",(0,t.jsx)(n.li,{children:"Use AWS KMS, Azure Key Vault, or similar"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Encryption in transit:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"HTTPS for all API communication"}),"\n",(0,t.jsx)(n.li,{children:"SSL/TLS for database connections"}),"\n",(0,t.jsx)(n.li,{children:"VPN for admin access"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"compliance",children:"Compliance"}),"\n",(0,t.jsx)(n.p,{children:"Consider data protection regulations:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GDPR"})," (if serving EU users)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CCPA"})," (if serving California users)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HIPAA"})," (if handling health data)"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"incident-response",children:"Incident Response"}),"\n",(0,t.jsx)(n.h3,{id:"security-incident-procedure",children:"Security Incident Procedure"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Detection:"})," Monitor logs and alerts"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Containment:"})," Isolate affected systems"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Investigation:"})," Analyze logs and determine scope"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Remediation:"})," Patch vulnerabilities, rotate credentials"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Recovery:"})," Restore from backups if needed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Post-mortem:"})," Document lessons learned"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"security-contacts",children:"Security Contacts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Vulnerability Reports:"})," ",(0,t.jsx)(n.a,{href:"mailto:the.michael.mclean@gmail.com",children:"the.michael.mclean@gmail.com"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Security Policy:"})," ",(0,t.jsx)(n.a,{href:"../../SECURITY.md",children:"SECURITY.md"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://owasp.org/www-project-top-ten/",children:"OWASP Top 10"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://fastapi.tiangolo.com/tutorial/security/",children:"FastAPI Security"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.postgresql.org/docs/current/security.html",children:"PostgreSQL Security"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.docker.com/engine/security/",children:"Docker Security"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.nist.gov/cyberframework",children:"NIST Cybersecurity Framework"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var s=i(6540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},8619:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/main-aca0df31aeef440bc0eedb737e893809.py"}}]);